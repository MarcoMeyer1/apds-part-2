version: 2.1

jobs:
  sonar-scanner:
    docker:
      - image: circleci/openjdk:11-jdk  # Use a Docker image with Java for SonarQube
    steps:
      - checkout  # Checkout your code from the repo

      # Install SonarScanner CLI
      - run:
          name: Install SonarScanner
          command: |
            wget https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-4.6.2.2472-linux.zip
            unzip sonar-scanner-cli-4.6.2.2472-linux.zip
            export PATH=$PATH:$(pwd)/sonar-scanner-4.6.2.2472-linux/bin

      # Run SonarScanner
      - run:
          name: Run SonarQube Scan
          command: |
            sonar-scanner \
              -Dsonar.projectKey=APDS-Part-2-Website \
              -Dsonar.sources=./client/src \
              -Dsonar.host.url=http://localhost:9000 \
              -Dsonar.login=sqp_a3100cf5f382181eb1fae7dab76f66473d479616

workflows:
  version: 2
  sonar-scan-workflow:
    jobs:
      - sonar-scanner
